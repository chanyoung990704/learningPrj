<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>게시글 상세보기</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div class="header">
    <h1 th:text="${post.title}">게시글 제목</h1>
</div>
<div class="navbar">
    <a th:href="@{/}">홈</a>
    <a th:href="@{/posts}">게시글 목록</a>
    <a th:href="@{/posts/new}">새 게시글</a>
    <a th:href="@{/login}">로그인</a>
    <a th:href="@{/register}">회원가입</a>
</div>
<div class="container">
    <p><strong>작성자:</strong> <span th:text="${post.member.username}"></span></p>
    <p><strong>작성일:</strong> <span th:text="${#dates.format(post.createdAt, 'yyyy-MM-dd HH:mm')}"></span></p>
    <div th:text="${post.content}" style="margin-bottom: 20px;"></div>

    <div>
        <h3>첨부파일</h3>
        <ul>
            <li th:each="attachment : ${post.attachments}">
                <a class="button" th:href="@{/files/download/{id}(id=${attachment.id})}" th:text="${attachment.originalName}"></a>
                (<span th:text="${attachment.size / 1024} + ' KB'"></span>)
            </li>
        </ul>
    </div>

    <div>
        <h3>댓글</h3>
        <ul th:if="${post.comments != null and !#lists.isEmpty(post.comments)}">
            <li th:each="comment : ${post.comments}">
                <strong th:text="${comment.member.username}"></strong>
                <span th:text="' (' + #dates.format(comment.createdAt, 'yyyy-MM-dd HH:mm') + ')'"></span>
                <p th:text="${comment.content}"></p>
            </li>
        </ul>
        <div th:if="${post.comments == null || #lists.isEmpty(post.comments)}">
            <p>댓글이 없습니다.</p>
        </div>
    </div>

    <div>
        <h3>댓글 작성</h3>
        <form th:action="@{/comments}" method="post">
            <input type="hidden" name="postId" th:value="${post.id}" />
            <label for="content">댓글:</label>
            <textarea id="content" name="content" rows="4" required></textarea>
            <button type="submit">댓글 작성</button>
        </form>
    </div>

    <div style="margin-top:20px;">
        <a class="button" th:href="@{/posts/edit/{id}(id=${post.id})}">수정</a>
        <a class="button" th:href="@{/posts/delete/{id}(id=${post.id})}" onclick="return confirm('삭제하시겠습니까?')">삭제</a>
        <a class="button" th:href="@{/posts}">목록으로 돌아가기</a>
    </div>
</div>
<div class="footer">
    <p>&copy; 2023 Spring Boot Project</p>
</div>
</body>
</html>
